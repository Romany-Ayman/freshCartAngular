<section class="w-75 mx-auto">
  <h1 class="text-center text-main my-2">forgot Password</h1>

  @if (step==1) {
  <form
    [formGroup]="verifyEmail"
    (ngSubmit)="verifyEmailSubmit()"
    class="shadow bg-main-light rounded-4 text-center p-3"
  >
    <div class="my-2 p-3">
      <label for="email"> Email </label>
      <input
        [ngClass]="{
          'is-valid':
            !verifyEmail.get('email')?.errors &&
            (verifyEmail.get('email')?.touched ||
              verifyEmail.get('email')?.dirty),
          'is-invalid':
            verifyEmail.get('email')?.errors &&
            (verifyEmail.get('email')?.touched ||
              verifyEmail.get('email')?.dirty)
        }"
        type="email"
        id="email"
        class="form-control"
        formControlName="email"
      />
      @if (verifyEmail.get('email')?.errors
      &&(verifyEmail.get("email")?.touched||verifyEmail.get("email")?.dirty)) {
      <div class="alert alert-danger w-50">
        @if (verifyEmail.get("email")?.getError('required')) {
        <p class="m-0">email is required</p>
        } @else if (verifyEmail.get("email")?.getError('email')) {
        <p class="m-0">Enter Valid Email</p>
        }
      </div>
      }
      <button
        [disabled]="verifyEmail.invalid || isLoading"
        type="submit"
        class="btn-main d-block mx-auto mt-3"
      >
        Register @if (isLoading) {<span
          ><i class="fa-solid fa-arrows-spin fa-spin"></i></span
        >}
      </button>
    </div>
  </form>
  } @else if (step==2) {
  <form
    [formGroup]="verifyCode"
    (ngSubmit)="verifyCodeSubmit()"
    class="shadow bg-main-light rounded-4 text-center p-3"
  >
    <div>
      <label for="resetCode">resetCode:</label>
      <input
        id="resetCode"
        type="text"
        class="form-control"
        formControlName="resetCode"
      />
      <button
        [disabled]="verifyCode.invalid || isLoading"
        type="submit"
        class="btn-main d-block mx-auto mt-3"
      >
        Send Code @if (isLoading) {<span
          ><i class="fa-solid fa-arrows-spin fa-spin"></i></span
        >}
      </button>
    </div>
  </form>
  } @else if (step==3) {
  <form
    [formGroup]="resetPassword"
    (ngSubmit)="resetPasswordsubmit()"
    class="shadow bg-main-light rounded-4 text-center p-3"
  >
    <div>
      <div class="my-2 p-3">
        <label for="email"> Email </label>
        <input
          [ngClass]="{
            'is-valid':
              !resetPassword.get('email')?.errors &&
              (resetPassword.get('email')?.touched ||
                resetPassword.get('email')?.dirty),
            'is-invalid':
              resetPassword.get('email')?.errors &&
              (resetPassword.get('email')?.touched ||
                resetPassword.get('email')?.dirty)
          }"
          type="email"
          id="email"
          class="form-control"
          formControlName="email"
        />
        @if (resetPassword.get('email')?.errors
        &&(resetPassword.get("email")?.touched||resetPassword.get("email")?.dirty))
        {
        <div class="alert alert-danger w-50">
          @if (resetPassword.get("email")?.getError('required')) {
          <p class="m-0">email is required</p>
          } @else if (resetPassword.get("email")?.getError('email')) {
          <p class="m-0">Enter Valid Email</p>
          }
        </div>
        }
      </div>

      <div class="my-2 p-3">
        <label for="newPasswoed"> newPasswoed </label>
        <input
          [ngClass]="{
            'is-valid':
              !resetPassword.get('newPassword')?.errors &&
              (resetPassword.get('newPassword')?.touched ||
                resetPassword.get('newPassword')?.dirty),
            'is-invalid':
              resetPassword.get('newPassword')?.errors &&
              (resetPassword.get('newPassword')?.touched ||
                resetPassword.get('newPassword')?.dirty)
          }"
          type="newPassword"
          id="newPassword"
          class="form-control"
          formControlName="newPassword"
        />
        @if (resetPassword.get('newPassword')?.errors
        &&(resetPassword.get("newPassword")?.touched||resetPassword.get("newPassword")?.dirty))
        {
        <div class="alert alert-danger w-50">
          @if (resetPassword.get("newPassword")?.getError('required')) {
          <p class="m-0">newPasswoed is required</p>
          } @else if (resetPassword.get("password")?.getError('pattern')) {
          <p class="m-0">It must consist of at least 6 letters</p>
          }
        </div>
        }
      </div>
      <button
        [disabled]="resetPassword.invalid || isLoading"
        type="submit"
        class="btn-main d-block mx-auto mt-3"
      >
        New Password @if (isLoading) {<span
          ><i class="fa-solid fa-arrows-spin fa-spin"></i></span
        >}
      </button>
    </div>
  </form>
  }
</section>
